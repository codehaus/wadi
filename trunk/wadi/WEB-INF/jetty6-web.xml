<?xml version="1.0"  encoding="ISO-8859-1"?>

<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure 1.2//EN" "http://jetty.mortbay.org/configure_1_2.dtd">

<Configure class="org.mortbay.jetty.webapp.WebAppHandler">

<!-- Set up the WADI Proxy Handler

  <Call name="addHandler">
    <Arg>
     <New class="org.codehaus.wadi.jetty5.Handler">
	  <Arg>
	   <Call class="java.util.regex.Pattern" name="compile">
	    <Arg>127\\.0\\.0\\.1|192\\.168\\.0\\.\\d{1,3}</Arg>
	   </Call>
	  </Arg>
     </New>
    </Arg>
  </Call>
 -->

<!-- Set up the WADI Filter -->
<!-- OhOh, this will overwrite Filters defined in web.xml ?? -->

  <Get name="ServletHandler">

    <Set name="Filters">
      <Array type="org.mortbay.jetty.servlet.FilterHolder">
	<Item>
	  <New class="org.mortbay.jetty.servlet.FilterHolder">
	    <Set name="Name">WadiFilter</Set>
	    <Set name="ClassName">org.codehaus.wadi.impl.Filter</Set>
	  </New>
	</Item>
      </Array>
    </Set>
    <Set name="FilterMappings">
      <Array type="org.mortbay.jetty.servlet.FilterMapping">
	<Item>
	  <New class="org.mortbay.jetty.servlet.FilterMapping">
	    <Set name="PathSpec">/*</Set>
	    <Set name="Dispatches">15</Set><!--  TODO: is this value still correct? -->
	    <Set name="FilterName">WadiFilter</Set>
	  </New>
	</Item>
      </Array>
    </Set>

  </Get>

<!-- needed for StopGracefully (set on Server) to work -->
<!--
  <Set name="StatsOn">true</Set>
-->
<!-- needed for session evacuation under load -->

<!-- Set up the WADI Session Manager -->

  <Get name="SessionHandler">
    <Set name="SessionManager">
      <New class="org.codehaus.wadi.jetty6.JettyManager"/>
    </Set>
  </Get>

</Configure>
