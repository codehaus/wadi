<?xml version="1.0"  encoding="ISO-8859-1"?>

<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure 1.2//EN" "http://jetty.mortbay.org/configure_1_2.dtd">

<Configure class="org.mortbay.jetty.servlet.WebApplicationContext">

<!-- Set up the WADI Proxy Handler -->

  <Call name="addHandler">
    <Arg>
     <New class="org.codehaus.wadi.sandbox.impl.jetty.Handler">
	  <Arg>
	   <Call class="java.util.regex.Pattern" name="compile">
	    <Arg>127\\.0\\.0\\.1|192\\.168\\.0\\.\\d{1,3}</Arg>
	   </Call>
	  </Arg>
     </New>
    </Arg>  
  </Call>      
 
<!-- Set up the WADI Filter -->

  <Call name="getWebApplicationHandler">

   <Call name="defineFilter">
    <Arg>WadiFilter</Arg>
    <Arg>org.codehaus.wadi.sandbox.impl.Filter</Arg>
   </Call>

   <Call name="addFilterPathMapping">
    <Arg>/*</Arg>
    <Arg>WadiFilter</Arg>
    <Arg type="int">15</Arg> <!-- ALL dispatch types -->
   </Call>

  </Call>
  
<!-- Set up the WADI Session Manager -->

  <Get name="ServletHandler">
    <Set name="SessionManager">
      <Call class="org.codehaus.wadi.sandbox.SpringManagerFactory" name="create">
	    <Arg>WEB-INF/wadi2-web.xml</Arg>
	    <Arg>SessionManager</Arg>
      </Call>
    </Set>
  </Get>

</Configure>
